<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registro Federal de Egreso</title>

<style>
:root{
  --celeste:#37BBED;
  --verde:#8DC21F;
  --gris:#e9ecef;
  --texto:#333;
}

*{
  box-sizing:border-box;
  font-family:Arial, Helvetica, sans-serif;
}

body{
  margin:0;
  background:#fff;
  color:var(--texto);
}

/* HEADER */
header{
  background:var(--celeste);
  padding:20px;
}

.header-top{
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:20px;
}

.header-top img{
  height:38px;
}

.header-title{
  color:#fff;
}

.header-title h1{
  font-size:22px;
  margin:0;
  font-weight:600;
}

.header-title h2{
  font-size:18px;
  margin:5px 0 0;
  font-weight:400;
}

/* MAIN */
main{
  max-width:520px;
  margin:0 auto;
  padding:20px 15px;
}

/* FORM */
.form-group{
  display:flex;
  margin-bottom:10px;
}

.form-label{
  background:var(--gris);
  padding:12px;
  min-width:45%;
  border-radius:6px 0 0 6px;
  font-size:14px;
}

.form-control{
  width:100%;
  padding:12px;
  border:1px solid #ccc;
  border-left:none;
  border-radius:0 6px 6px 0;
  font-size:14px;
}

.form-control:focus{
  outline:none;
}

/* LINK */
.blockchain-link{
  font-size:14px;
  margin:10px 0 20px;
}

.blockchain-link a{
  color:var(--celeste);
  text-decoration:none;
}

/* BUTTONS */
.buttons{
  display:flex;
  gap:10px;
}

.btn{
  flex:1;
  padding:12px;
  border:none;
  border-radius:6px;
  font-size:16px;
  color:#fff;
  cursor:pointer;
}

.btn-reset{
  background:#4cc1ef;
}

.btn-search{
  background:var(--verde);
}

/* RESULT */
#infoEstudiante{
  display:none;
  margin-top:25px;
}

.student-info{
  background:var(--celeste);
  color:#fff;
  padding:12px;
  border-radius:6px;
  font-weight:bold;
  margin-bottom:10px;
}

/* TABLE */
.table-wrapper{
  overflow-x:auto;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}

th,td{
  border:1px solid #ccc;
  padding:8px;
  text-align:left;
}

th{
  background:var(--celeste);
  color:#fff;
}

/* FOOTER TEXT */
.info-text{
  font-size:13px;
  margin-top:25px;
  line-height:1.5;
}

/* RESPONSIVE DESKTOP */
@media(min-width:768px){
  main{
    max-width:900px;
  }
  .form-label{
    min-width:30%;
  }
}
</style>
</head>

<body>

<header>
  <div class="header-top">
    <img src="https://refe.educacion.gob.ar/img/ReFE/Banner/ReFE-Banner.svg" alt="ReFE">
  </div>
  <div class="header-title">
    <h1>Dirección de Validez Nacional de Títulos y Estudios</h1>
    <h2>Registro Federal de Egreso</h2>
  </div>
</header>

<main>

<form id="form-busqueda">

  <div class="form-group">
    <div class="form-label">Tipo de Documento</div>
    <select id="tipoDoc" class="form-control">
      <option value="">-- Selecciona una opción --</option>
      <option>DNI</option>
      <option>LE</option>
      <option>LC</option>
      <option>DOCUMENTO EXTRANJERO</option>
    </select>
  </div>

  <div class="form-group">
    <div class="form-label">Número de Documento</div>
    <input id="numeroDoc" class="form-control">
  </div>

  <div class="form-group">
    <div class="form-label">Apellido</div>
    <input id="apellido" class="form-control">
  </div>

  <div class="form-group">
    <div class="form-label">Nombre</div>
    <input id="nombre" class="form-control">
  </div>

  <div class="blockchain-link">
    Si deseas ver tu título en la Blockchain Federal Argentina,
    <a href="#">haz click aquí</a>
  </div>

  <div class="buttons">
    <button type="button" class="btn btn-reset" id="nuevaBusqueda">Nueva búsqueda</button>
    <button type="button" class="btn btn-search" id="buscarBtn">Buscar</button>
  </div>

</form>

<div id="infoEstudiante">
  <div class="student-info" id="studentName"></div>

  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Tipo</th>
          <th>DNI</th>
          <th>Título</th>
          <th>Jurisdicción</th>
          <th>Institución</th>
          <th>CUE</th>
          <th>Fecha</th>
          <th>Serie</th>
          <th>Blockchain</th>
        </tr>
      </thead>
      <tbody id="tablaBody"></tbody>
    </table>
  </div>
</div>

<div class="info-text">
  Por la Resolución CFE N° 440/23, los títulos son emitidos en formato digital. Para títulos emitidos desde esa fecha, el ReFE es el nuevo instrumento de legalización, certificación y confronte de autenticidad de la documentación educativa correspondiente a los niveles de educación secundaria y de educación superior, para su presentación dentro del territorio argentino.
Para títulos emitidos con anterioridad, consultar el circuito de legalización en https://www.argentina.gob.ar/servicio/legalizar-el-certificado-de-estudio-secundario-yo-terciario
</div>

</main>

<script>
const datosEstudiantes = [
  {
    dni:"37660995",
    nombre:"LUCAS IVAN TEMPONE",
    tipoDoc:"DNI",
    titulo:"ECONOMÍA Y ADMINISTRACIÓN",
    jurisdiccion:"BUENOS AIRES",
    institucion:"E DE COMERCIO N°29",
    cue:"00612275",
    fechaEgreso:"20/12/2020",
    serie:"06-08336-2020",
    hash:"0xABC"
  }
];

// conectores habituales de apellidos compuestos
const conectores = ["DE","DEL","DE LA","DE LAS","DE LOS","LA","LAS","LOS","SAN","SANTA"];

buscarBtn.onclick = () => {
  const dni = numeroDoc.value.trim();
  const r = datosEstudiantes.find(e => e.dni === dni);

  if(!r){
  alert("No se encontró el DNI");
  infoEstudiante.style.display="none";
  apellido.readOnly = false;   // ← línea 1
  nombre.readOnly = false;     // ← línea 2
  return;
}
  // ---- DETECCIÓN DE APELLIDO COMPUESTO ----
  const partes = r.nombre.split(" ");
  let apellido = partes.pop();

if (partes.length >= 2) {
  const posibleCompuesto = partes.slice(-2).join(" ") + " " + apellido;
  if (conectores.includes(posibleCompuesto)) {
    apellido = partes.splice(-2).join(" ") + " " + apellido;
  }
}

if (partes.length >= 1) {
  const posibleSimple = partes[partes.length - 1] + " " + apellido;
  if (conectores.includes(posibleSimple)) {
    apellido = partes.pop() + " " + apellido;
  }
}
  const nombres = partes.join(" ");

  apellidoInput = apellido;
  nombreInput = nombres;

  apellido.value = r.apellido;
nombre.value = r.nombre;
  
  // ---- BLOQUEAR EDICIÓN ----
  apellido.readOnly = true;
  nombre.readOnly = true;

  infoEstudiante.style.display="block";
  studentName.textContent = `${r.nombre} ${r.apellido}`;
  tipoDoc.value = r.tipoDoc;

  tablaBody.innerHTML = `
    <tr>
      <td>${r.tipoDoc}</td>
      <td>${r.dni}</td>
      <td>${r.titulo}</td>
      <td>${r.jurisdiccion}</td>
      <td>${r.institucion}</td>
      <td>${r.cue}</td>
      <td>${r.fechaEgreso}</td>
      <td>${r.serie}</td>
      <td>${r.hash}</td>
    </tr>
  `;
};

nuevaBusqueda.onclick = () => {
  document.getElementById("form-busqueda").reset();
  infoEstudiante.style.display="none";
  apellido.readOnly = false;
  nombre.readOnly = false;
};
</script>

</body>
</html>
